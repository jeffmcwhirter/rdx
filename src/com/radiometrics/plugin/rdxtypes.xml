<types  supercategory="Science and Education">

  <type name="rdx_collection"  description="RDX Collection" handler="org.ramadda.repository.type.ExtensibleGroupTypeHandler" category="RDX"   metadata="rdx_notification" >
     <property name="icon" value="/rdx/radiometrics_icon.png"/>
     <wiki><![CDATA[
+section title={{name}}
:reload seconds=30 showCheckbox=true showLabel=true
{{description wikify=true}}
:rem These properties say to use the children of this group as data
{{property name=doEntries value=true}}
{{property name=addAttributes value=true}} 
:rem Define properties that all displays use
:rem The convert data adds a derived quantity
{{group filterFields=network_up,data_down hideFilterWidget=true sortFields=name
convertData="derived(field=minutes_since, function=Math.round(Utils.toMinutes(new Date().getTime()-last_data)));" 
}} 
:rem This is used to show the filter widgets. The changes get applied to all displays
{{display_blank hideFilterWidget=false showMenu=true}}
{{display_table  height="300"  showMenu=true
linkField=entry_url iconField=icon  
fields="name,instrument_id,typeName,city,state,network_up,data_down,minutes_since"
data_down.colorTable=plotly_reds
minutes_since.colorTable=plotly_reds
network_up.colorByMap="true:green,false:red"
colorCells="network_up,data_down,minutes_since"
}} 
{{display_barchart fields=data_down,minutes_since indexField=name forceStrings=true chartRight=80}}
{{display_map  width="100%"  height="400" iconField=icon iconSize=16
linkField=entry_url titleField=name descriptionField=description
doGridPoints=true  boundsScale=0.15
showPoints=true
radius="12"  strokeColor=transparent
colorBy=testnumber
colorBySteps=15,60,720
colorTableShowRange=false
colorTableLabels="0-15 minutes,15-60 minutes,1-12 hours,>12 hours"
colors=green,yellow,red,purple
xglyph1="type:label,pos:sw,label:data_colon_ ${data_down}_nl_minutes_colon_ ${minutes_since},dy:0,dx:5"
xglyph3="type:axis,pos:sw,dx:15,dy:10,height:35,width:40"
xglyph4="type:3dbar,pos:sw,dx:20,dy:10,height:30,width:8,baseHeight:5,sizeBy:testnumber"
xglyph5="type:3dbar,pos:sw,dx:35,dy:10,height:30,width:8,baseHeight:5,sizeBy:minutes_since,color:red"
}}
-section
]]>
</wiki>
</type>



  <type name="rdx_instrument"  description="RDX Instrument" handler="org.ramadda.repository.type.ExtensibleGroupTypeHandler" category="RDX" foruser="false">
     <property name="icon" value="/rdx/system-monitor.png"/>
     <property name="form.date.show" value="false"/>
     <property name="form.area.show" value="false"/>
     <property name="form.location.show" value="true"/>
     <property name="form.resource.show" value="false"/>
     <property name="form.datatype.show" value="false"/>
     <property name="form.altitude.show" value="true"/>
     <property name="form.altitude.top.show" value="false"/>
     <column name="instrument_id" type="string"  label="ID"   cansearch="true"  />
     <column name="ipaddress" type="string"  label="IP Address"  />     
     <column name="computer_os" type="enumerationplus"  label="Computer OS"   />
     <column name="contact_name" type="string"  label="Contact"   />
     <column name="contact_email" type="email"  label="Contact Email"   />
     <column name="city" type="enumerationplus"  label="City"   />
     <column name="state" type="enumerationplus"  label="State"   values="file:/org/ramadda/repository/resources/geo/statesmap.txt" cansearch="true" />
     <column name="monitoring_enabled" type="boolean"  label="Monitoring Enabled" default="true"  />
     <column name="last_maintenance" type="datetime"  label="Last Maintenance Time"   />
     <column name="network_up" type="boolean"  label="Network Up" cansearch="true"  default="true">
       <display value="true" background="green"  mapFillColor="green"/>
       <display value="false" background="red"  mapFillColor="red"/>
     </column>
     <column name="data_down" type="int"  label="Data Down"   cansearch="true" />
     <column name="last_network_connection" type="datetime"  label="Last Network Connection"   />
     <column name="last_data" type="datetime"  label="Last Data Time"   />
     <column name="testnumber" type="int"  label="Test number"   cansearch="true" >
       <display min="0"  max="15" background="green"  mapFillColor="green"/>
       <display min="15"  max="60" background="yellow"  mapFillColor="yellow"/>
       <display min="60"  max="720" background="red"  mapFillColor="red"/>       
       <display min="720"   background="purple"  mapFillColor="purple"/>       
     </column>
     <bubble><![CDATA[
:heading {{name link=true}}
{{information details=true}}
]]>
</bubble>
     <wiki><![CDATA[
+section title="Instrument: {{name}}"
{{description wikify=true}}
+row
+col-8
{{information showBase=false showDetails=true}}
-col
+col-4
{{mapentry}}
-col
-row
----
:heading Data
{{group changeEntries=true changeEntriesLabel="Select Skewt" }} 
{{display type="skewt" entry="child:" showProgress=true message=""}}
-section
]]>
</wiki>
 </type>

 <type name="rdx_instrument_radiometer"  super="rdx_instrument"
  description="RDX Radiometer" handler="org.ramadda.repository.type.ExtensibleGroupTypeHandler" >
     <property name="icon" value="/rdx/radiometer.gif"/>
 </type>

 <type name="rdx_instrument_windprofiler"  super="rdx_instrument" description="RDX Wind Profiler" handler="org.ramadda.repository.type.ExtensibleGroupTypeHandler" >
     <property name="icon" value="/rdx/windprofiler.png"/>
 </type>
 
 <type name="rdx_instrument_sodar"  super="rdx_instrument" description="RDX Sodar" handler="org.ramadda.repository.type.ExtensibleGroupTypeHandler" >
     <property name="icon" value="/rdx/sodar.png"/>
 </type>



</types>
